<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>雨天信箱 - The Raindrop Box</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📮</text></svg>">
</head>
<body class="sunny-mode">
    <div id="weather-background"></div>
    
    <div class="container glass-effect fade-in">
        <header>
            <h1>📮 雨天信箱</h1>
            <p>The Raindrop Box</p>
            <div class="status-indicator status-sunny" id="current-weather">🌤️ 晴天模式</div>
        </header>

        <!-- 晴天界面 -->
        <div id="sunny-interface">
            <div class="message-form">
                <h2>✉️ 写下你的秘密</h2>
                <div class="form-group">
                    <label for="nickname-input">你的昵称（可选）</label>
                    <input type="text" id="nickname-input" placeholder="匿名寄信人" maxlength="20">
                </div>
                <div class="form-group">
                    <label for="message-input">你的秘密（最多500字）</label>
                    <textarea id="message-input" placeholder="在这里写下你想说的话..." maxlength="500"></textarea>
                    <div class="char-counter">已输入 <span class="char-count">0</span>/500 字</div>
                </div>
                <button id="submit-btn" class="primary-btn">投递秘密</button>
            </div>
            
            <div class="weather-info">
                <p>🌤️ 当前天气晴朗，信箱封存中</p>
                <p>🌧️ 等到下雨时，所有秘密将会公开</p>
            </div>
        </div>

        <!-- 雨天界面 -->
        <div id="rainy-interface" style="display: none;">
            <div class="message-form">
                <h2>🌧️ 雨中分享</h2>
                <div class="form-group">
                    <label for="rainy-message-input">你的秘密（最多500字）</label>
                    <textarea id="rainy-message-input" placeholder="雨声中写下你的心声..." maxlength="500"></textarea>
                    <div class="char-counter">已输入 <span class="char-count">0</span>/500 字</div>
                </div>
                <button id="rainy-submit-btn" class="primary-btn">投递秘密</button>
            </div>

            <div class="messages-list">
                <h2>📜 公开的秘密</h2>
                <div id="messages-container">
                    <div class="loading">加载中...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 成功模态框 -->
    <div id="success-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div id="share-card" class="share-card">
                <h3>📨 存票凭证</h3>
                <p>第 <span id="card-message-id">0</span> 号寄信人</p>
                <p>存入时间: <span id="card-created-at">-</span></p>
                <p>服务器状态: <span id="card-weather-status">-</span></p>
                <p>总消息数: <span id="card-total-messages">0</span></p>
                <div id="qr-code-container"></div>
                <p class="qr-url">https://dropbox.techccy.dpdns.org</p>
            </div>
            
            <div class="modal-actions">
                <button id="save-card-btn" class="primary-btn">保存存票</button>
                <button id="close-modal-btn" class="secondary-btn">关闭</button>
            </div>
        </div>
    </div>

    <!-- 脚本引用 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="/static/js/app.js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"3ff22d5e71d340e1a0bf66284754097f","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>